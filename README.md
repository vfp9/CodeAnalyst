# CodeAnalyst

本文档由 xinjie 于 2020-10-03 翻译

这是一个帮助 FoxPro 开发人员确定应该（或可以）对特定代码区域进行重构的开发工具。

Code Analyst 自身是可扩展的，它允许开发人员创建自己的重构规则，然后根据需要启用或禁用它们。部分代码基于 Code References 工具。

规则可用于与代码相关的各个方面。例如，对象规则可能会拆分所要分析的表单上的所有对象，以确保它们都使用了规则所限的命名规则。

你也可以选择分析单一的文件、当前项目、特定目录（和子目录）。

#### 默认的重构规则

工具自身具有四种类型的规则：
* 文件
* 方法/函数
* 对象
* 行

请注意，如果你不想使用它们，你可以根据需要禁用它们。

#### 默认的方法规则

* 检查方法代码中注释和代码的比例是否合适。
* 检查 With 结构中是否存在 Return 语句，这是一个已知的造成 C5 错误的原因。
* 检查方法代码中的行数是否过多（默认150行），此规则用于提高代码的可读性。
* 检查代码中循环结构的数量（默认值：5）。
* 验证每个方法中是否具有返回值。
* 验证方法的返回值是否超过 3 个。

#### 默认的对象规则

* 检查“取消”按钮的 Cancel 属性值是否为 .T. 。
* 检查对象名是否使用了默认值。
* 检查对象的方法中是否存在相似的行数（如果存在，则需要考虑是否应该进行重构）。
* 检查代码中是否使用 This.Parent 来表示表单。
* 检查 Grid 的 header 是否使用重复的方法，这暗示你或许需要对 BindEvent 进行重构。

#### 默认行规则

* 如果你在一行代码中使用 CTOD（） 函数而不是 DATE（） 函数则会发出警告。
* 检查同一行代码中 .Parent 的数量是否多于 3 个，这表明你可能使用了过多的 .Parent 。
